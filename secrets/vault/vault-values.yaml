server:
  enabled: true

  image:
    repository: "hashicorp/vault"
    tag: "1.15.0"

  resources:
    requests:
      memory: 256Mi
      cpu: 250m
    limits:
      memory: 512Mi
      cpu: 500m

  ha:
    enabled: true
    replicas: 3

    raft:
      enabled: true
      setNodeId: true

      config: |
        ui = true

        listener "tcp" {
          tls_disable = 0
          address = "[::]:8200"
          cluster_address = "[::]:8201"
          tls_cert_file = "/vault/tls/tls.crt"
          tls_key_file = "/vault/tls/tls.key"
        }

        storage "raft" {
          path = "/vault/data"

          retry_join {
            leader_api_addr = "https://vault-0.vault-internal:8200"
            leader_ca_cert_file = "/vault/tls/ca.crt"
          }
          retry_join {
            leader_api_addr = "https://vault-1.vault-internal:8200"
            leader_ca_cert_file = "/vault/tls/ca.crt"
          }
          retry_join {
            leader_api_addr = "https://vault-2.vault-internal:8200"
            leader_ca_cert_file = "/vault/tls/ca.crt"
          }
        }

        service_registration "kubernetes" {}

        seal "awskms" {
          region = "us-east-1"
          kms_key_id = "VAULT_KMS_KEY_ID"
        }

  dataStorage:
    enabled: true
    size: 10Gi
    storageClass: gp3

  auditStorage:
    enabled: true
    size: 10Gi

  extraEnvironmentVars:
    VAULT_ADDR: "https://vault.docuthinker.local:8200"
    VAULT_SKIP_VERIFY: "false"

  service:
    enabled: true
    type: LoadBalancer
    port: 8200
    targetPort: 8200

  ingress:
    enabled: true
    ingressClassName: nginx
    annotations:
      cert-manager.io/cluster-issuer: "letsencrypt-prod"
    hosts:
      - host: vault.docuthinker.com
        paths:
          - /
    tls:
      - secretName: vault-tls
        hosts:
          - vault.docuthinker.com

ui:
  enabled: true
  serviceType: "LoadBalancer"
  serviceNodePort: null
  externalPort: 8200

injector:
  enabled: true

  image:
    repository: "hashicorp/vault-k8s"
    tag: "1.3.0"

  resources:
    requests:
      memory: 256Mi
      cpu: 250m
    limits:
      memory: 512Mi
      cpu: 500m

  authPath: "auth/kubernetes"

  logLevel: "info"

  revokeOnShutdown: true

  webhook:
    failurePolicy: Fail
    matchPolicy: Exact
    timeoutSeconds: 30

csi:
  enabled: true

  image:
    repository: "hashicorp/vault-csi-provider"
    tag: "1.4.0"

  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 100m
      memory: 256Mi

  daemonSet:
    updateStrategy:
      type: RollingUpdate
      maxUnavailable: 1

  pod:
    annotations: {}
    extraLabels: {}

  priorityClassName: ""

  serviceAccount:
    annotations: {}

  volumeMounts: null

  volumes: null

serverTelemetry:
  prometheusOperator: true
